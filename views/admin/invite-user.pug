//- views/admin/invite-user.pug
extends ../layouts/admin-layout.pug

block content
  .flex.items-center.justify-between.mb-6
    a(href="/admin/all", class="text-blue-600 hover:underline") ‚Üê Back to Users
    h1(class="text-xl font-semibold")= pageTitle

  //- Main card
  .bg-white.shadow-lg.rounded-xl.p-6
    if errorMessage
      .mb-4.text-red-600.text-sm= errorMessage

    include ../mixins/csrf
    form(method="POST", action=formAction, novalidate)
      +csrfField()

      .space-y-4
        .grid.grid-cols-1.gap-4
          //- Display Name (optional)
          .form-group
            label.block.text-sm.font-medium.mb-1(for="displayName") Name (optional)
            input#displayName(
              type="text"
              name="displayName"
              value=(formData && formData.displayName) || ''
              placeholder="e.g. Steve Hull"
              class="w-full border border-gray-300 rounded-lg px-3 py-2"
            )

          //- Email
          .form-group
            label.block.text-sm.font-medium.mb-1(for="email") Email
            input#email(
              type="email"
              name="email"
              required
              value=(formData && formData.email) || ''
              class="w-full border border-gray-300 rounded-lg px-3 py-2"
            )

          //- Confirm Email
          .form-group
            label.block.text-sm.font-medium.mb-1(for="confirmEmail") Confirm Email
            input#confirmEmail(
              type="email"
              name="confirmEmail"
              required
              value=(formData && formData.confirmEmail) || ''
              class="w-full border border-gray-300 rounded-lg px-3 py-2"
            )

          //- Intended Role
          .form-group
            label.block.text-sm.font-medium.mb-1(for="intendedRole") Intended Role
            select#intendedRole(
              name="intendedRole"
              required
              class="w-full border border-gray-300 rounded-lg px-3 py-2 bg-white"
            )
              -
                const selectedRole =
                  (formData && formData.intendedRole) ? String(formData.intendedRole) : 'student';
              option(value="student", selected=selectedRole === 'student') student
              option(value="instructor", selected=selectedRole === 'instructor') instructor
              option(value="admin", selected=selectedRole === 'admin') admin

          //- Allowed checkbox
          .form-group
            -
              const allowed =
                (formData && typeof formData.isAllowed !== 'undefined')
                  ? (String(formData.isAllowed) === 'true' || String(formData.isAllowed) === '1')
                  : true;
            label.block.text-sm.font-medium.mb-1 Access
            label.inline-flex.items-center.gap-2
              input#isAllowed(type="checkbox", name="isAllowed", value="1", checked=allowed)
              span.text-sm Allow signup for this email

      .mt-4
        button(type="submit", class="inline-flex items-center px-4 py-2 rounded-lg bg-blue-600 text-white")= submitLabel
